#include <limits>

#include <LTEngine/random/unsecure_random.hpp>


using namespace LTEngine;
using namespace LTEngine::Random;


// Generated by: https://www.random.org/integer-sets/
const u8 randomData[] = {
    186, 59,  75,  194, 122, 152, 150, 19,  111, 232, 50,  126, 220, 133, 205, 137, 142, 2,   108, 245, 92,  112, 157, 103, 52,
    23,  225, 215, 101, 68,  156, 114, 113, 125, 101, 214, 238, 181, 8,   141, 150, 14,  143, 46,  114, 63,  67,  49,  231, 195,
    194, 120, 23,  167, 86,  11,  104, 179, 173, 133, 26,  74,  250, 239, 119, 182, 126, 90,  14,  234, 139, 142, 33,  5,   148,
    56,  60,  197, 243, 53,  27,  75,  109, 52,  54,  190, 180, 166, 198, 177, 212, 202, 222, 112, 25,  58,  245, 215, 132, 252,
    136, 243, 55,  7,   85,  199, 194, 167, 8,   107, 110, 176, 184, 244, 127, 13,  234, 113, 91,  59,  34,  172, 173, 58,  114,
    207, 33,  155, 36,  230, 218, 191, 205, 206, 127, 141, 183, 159, 9,   140, 139, 198, 224, 27,  54,  110, 75,  45,  103, 185,
    17,  174, 35,  90,  150, 83,  29,  108, 130, 142, 8,   2,   5,   131, 73,  58,  154, 228, 128, 32,  96,  244, 15,  107, 239,
    145, 199, 156, 251, 85,  106, 236, 67,  82,  196, 134, 155, 84,  171, 160, 193, 62,  21,  126, 14,  5,   9,   72,  127, 182,
    92,  101, 202, 155, 160, 210, 137, 26,  98,  156, 129, 244, 138, 40,  114, 197, 28,  117, 161, 61,  90,  2,   141, 243, 73,
    211, 34,  105, 241, 199, 158, 210, 44,  17,  30,  47,  197, 163, 82,  171, 3,   176, 172, 45,  93,  137, 54,  167, 56,  221,
    244, 153, 13,  28,  66,  141, 102, 121, 129, 182, 8,   226, 234, 5,   246, 22,  254, 75,  93,  78,  33,  50,  156, 27,  57,
    92,  204, 225, 32,  217, 238, 55,  106, 230, 63,  70,  34,  158, 187, 16,  146, 215, 204, 252, 164, 145, 91,  116, 152, 25,
    249, 113, 202, 169, 248, 0,   167, 247, 245, 140, 34,  211, 216, 114, 40,  222, 83,  51,  119, 32,  148, 89,  162, 183, 88,
    247, 63,  221, 78,  167, 55,  209, 104, 136, 30,  15,  130, 150, 3,   12,  84,  36,  197, 220, 102, 96,  56,  202, 164, 210,
    233, 229, 83,  132, 46,  125, 152, 120, 210, 214, 246, 38,  140, 215, 163, 226, 141, 84,  232, 185, 251, 32,  175, 186, 142,
    187, 61,  15,  235, 4,   18,  223, 188, 103, 14,  109, 173, 55,  174, 221, 25,  246, 62,  158, 232, 16,  54,  119, 141, 18,
    172, 49,  128, 180, 71,  168, 154, 147, 171, 234, 187, 149, 146, 110, 15,  29,  29,  188, 190, 93,  192, 119, 173, 196, 149,
    4,   22,  169, 209, 124, 16,  98,  102, 255, 128, 183, 88,  206, 100, 126, 176, 25,  145, 129, 26,  205, 142, 106, 64,  136,
    16,  183, 119, 111, 200, 162, 219, 209, 225, 96,  156, 247, 35,  131, 2,   167, 14,  91,  7,   227, 118, 97,  101, 62,  21,
    6,   110, 178, 0,   46,  231, 68,  39,  33,  247, 0,   253, 18,  141, 255, 28,  19,  219, 84,  10,  183, 234, 191, 59,  102,
    63,  154, 71,  57,  217, 3,   38,  250, 180, 224, 158, 220, 38,  51,  93,  244, 15,  241, 80,  175, 234, 176, 202, 111, 89,
    208, 21,  75,  50,  174, 229, 19,  95,  164, 242, 146, 59,  181, 22,  207, 227, 237, 71,  230, 124, 127, 192, 196, 239, 77,
    51,  113, 88,  188, 1,   32,  174, 195, 43,  58,  20,  247, 141, 22,  69,  36,  91,  67,  156, 183, 158, 243, 40,  144, 194,
    111, 109, 218, 171, 198, 144, 186, 33,  22,  0,   20,  13,  149, 86,  12,  201, 88,  69,  129, 193, 67,  162, 191, 212, 101,
    187, 85,  11,  168, 73,  246, 185, 44,  200, 48,  13,  181, 204, 65,  230, 70,  244, 141, 221, 49,  160, 69,  145, 27,  86,
    227, 5,   20,  187, 19,  198, 238, 176, 29,  132, 12,  14,  137, 148, 162, 205, 100, 186, 37,  222, 131, 203, 248, 192, 34,
    18,  227, 240, 78,  238, 237, 135, 198, 26,  7,   187, 49,  21,  62,  54,  194, 136, 134, 99,  41,  128, 193, 230, 195, 7,
    14,  28,  234, 98,  207, 204, 115, 214, 156, 50,  71,  187, 20,  22,  96,  246, 209, 18,  188, 30,  93,  252, 162, 21,  19,
    129, 179, 177, 144, 99,  40,  175, 160, 120, 56,  247, 200, 25,  150, 92,  111, 66,  44,  151, 7,   36,  8,   193, 54,  121,
    182, 51,  27,  116, 93,  140, 199, 32,  241, 235, 19,  194, 243, 146, 143, 111, 137, 176, 184, 104, 1,   187, 88,  145, 74,
    51,  138, 165, 120, 230, 23,  44,  181, 119, 93,  103, 94,  61,  32,  52,  223, 54,  249, 207, 38,  47,  250, 16,  200, 17,
    233, 94,  195, 147, 109, 168, 83,  4,   69,  211, 67,  95,  221, 251, 41,  121, 81,  173, 229, 158, 140, 152, 171, 14,  25,
    167, 157, 250, 215, 238, 198, 21,  225, 144, 119, 28,  108, 244, 91,  145, 105, 50,  22,  170, 242, 248, 199, 147, 88,  232,
    205, 27,  162, 115, 113, 116, 213, 231, 193, 23,  31,  10,  245, 103, 95,  134, 82,  101, 79,  190, 13,  4,   219, 200, 247,
    33,  54,  44,  96,  169, 114, 90,  154, 241, 86,  229, 98,  70,  32,  224, 66,  13,  97,  251, 31,  187, 248, 6,   130, 55,
    255, 234, 242, 105, 208, 64,  81,  29,  26,  109, 96,  5,   239, 210, 85,  235, 21,  59,  0,   135, 179, 192, 70,  10,  4,
    131, 44,  207, 19,  50,  210, 100, 140, 13,  93,  197, 76,  189, 159, 190, 61,  157, 34,  120, 32,  107, 24,  28,  242, 46,
    141, 182, 73,  236, 211, 72,  184, 54,  119, 62,  59,  117, 208, 82,  95,  121, 166, 18,  176, 249, 255, 83,  226, 86,  213,
    103, 113, 60,  168, 248, 130, 246, 127, 199, 8,   237, 249, 135, 89,  229, 189, 193, 190, 250, 230, 8,   106, 221, 115, 96,
    59,  86,  150, 171, 60,  242, 222, 235, 143, 63,  1,   28,  0,   207, 46,  248, 97,  126, 252, 150, 241, 107, 12,  212, 213,
    29,  142, 33,  61,  75,  139, 94,  127, 210, 24,  130, 135, 137, 219, 134, 13,  72,  236, 153, 97,  165, 207, 66,  148, 150,
    180, 177, 157, 255, 8,   122, 36,  59,  132, 219, 166, 174, 158, 53,  197, 51,  3,   23,  100, 41,  214, 226, 137, 40,  90,
    57,  4,   183, 195, 165, 33,  47,  6,   67,  117, 90,  40,  83,  30,  93,  86,  243, 114, 79,  122, 103, 148, 81,  0,   33,
    222, 219, 179, 143, 112, 120, 36,  18,  251, 170, 154, 85,  214, 224, 206, 184, 152, 189, 235, 122, 128, 219, 18,  183, 3,
    108, 115, 130, 195, 70,  38,  163, 198, 200, 23,  239, 106, 85,  205, 25,  167, 135, 151, 2,   79,  154, 38,  124, 12,  30,
    97,  93,  155, 170, 70,  15,  99,  180, 59,  133, 236, 244, 80,  243, 159, 254, 178, 141, 25,  10,  85,  11,  54,  62,  105,
    71,  187, 165, 42,  84,  247, 203, 23,  34,  204, 41,  211, 92,  231, 139, 189, 74,  87,  183, 235, 200, 33,  186, 173, 151,
    98,  250, 99,  53,  50,  19,  174, 201, 208, 190, 211, 10,  140, 125, 85,  38,  164, 116, 196, 21,  66,  222, 71,  33,  114,
    163, 31,  27,  133, 132, 104, 175, 162, 227, 1,   16,  102, 106, 9,   89,  173, 246, 172, 78,  25,  237, 88,  34,  224, 221,
    185, 24,  26,  41,  229, 160, 218, 140, 117, 132, 13,  72,  205, 49,  79,  83,  204, 2,   55,  38,  17,  165, 207, 159, 196,
    7,   66,  183, 203, 228, 238, 57,  29,  43,  94,  186, 147, 84,  4,   246, 226, 76,  216, 110, 232, 157, 125, 41,  104, 62,
    212, 181, 237, 91,  47,  50,  156, 198, 151, 195, 102, 58,  237, 166, 36,  212, 132, 41,  177, 52,  21,  206, 35,  96,  113,
    149, 245, 253, 87,  48,  185, 83,  239, 157, 153, 26,  112, 204, 163, 121, 24,  127, 27,  193, 42,  66,  174, 244, 216, 156,
    182, 239, 142, 143, 86,  198, 180, 35,  250, 11,  200, 195, 26,  34,  65,  38,  167, 52,  172, 56,  33,  211, 8,   247, 128,
    98,  39,  77,  183, 45,  233, 182, 59,  76,  119, 114, 246, 83,  115, 205, 84,  227, 188, 90,  110, 254, 219, 99,  15,  88,
    224, 193, 225, 93,  210, 84,  246, 53,  75,  175, 226, 252, 191, 50,  154, 141, 194, 135, 136, 148, 206, 200, 131, 41,  251,
    153, 155, 10,  5,   72,  51,  157, 217, 176, 199, 217, 40,  8,   226, 46,  129, 94,  170, 70,  92,  246, 90,  102, 218, 100,
    89,  212, 126, 240, 53,  253, 157, 34,  187, 26,  238, 188, 19,  162, 254, 1,   180, 170, 161, 213, 128, 153, 229, 219, 212,
    116, 87,  184, 31,  185, 130, 73,  111, 57,  132, 70,  39,  71,  211, 122, 42,  151, 155, 201, 54,  214, 81,  66,  3,   149,
    9,   113, 51,  217, 43,  252, 253, 136, 200, 177, 126, 86,  224, 175, 85,  156, 41,  64,  137, 233, 106, 199, 187, 46,  251,
    127, 238, 141, 102, 155, 211, 72,  49,  52,  30,  221, 179, 207, 77,  56,  73,  37,  216, 201, 126, 41,  233, 0,   24,  224,
    21,  3,   212, 173, 129, 1,   137, 139, 196, 95,  217, 187, 186, 79,  119, 250, 231, 13,  128, 1,   90,  77,  241, 124, 212,
    85,  112, 10,  198, 183, 63,  204, 89,  151, 59,  228, 201, 49,  102, 221, 143, 141, 107, 72,  157, 55,  0,   194, 43,  242,
    58,  195, 203, 125, 12,  16,  171, 6,   166, 80,  160, 54,  18,  224, 112, 185, 85,  132, 89,  134, 193, 250, 136, 128, 51,
};


u8 RandomUnsecure::next_u8() {
	m_index = (m_index + 1) % 256;
	return randomData[m_index];
}

u16 RandomUnsecure::next_u16() {
	return (next_u8() << 8) | next_u8();
}

u32 RandomUnsecure::next_u32() {
	return (next_u16() << 16) | next_u16();
}

u64 RandomUnsecure::next_u64() {
	return ((u64)next_u32() << 32) | (u64)next_u32();
}


i8 RandomUnsecure::next_i8() {
	return (i8)next_u8();
}

i16 RandomUnsecure::next_i16() {
	return (i16)next_u16();
}

i32 RandomUnsecure::next_i32() {
	return (i32)next_u32();
}

i64 RandomUnsecure::next_i64() {
	return (i64)next_u64();
}


f32 RandomUnsecure::next_f32() {
	return (f32)next_u16() / std::numeric_limits<u16>::max();
}

f64 RandomUnsecure::next_f64() {
	return (f64)next_u32() / std::numeric_limits<u32>::max();
}


void RandomUnsecure::nextBytes(void *buffer, size_t size) {
	for (u32 i = 0; i < size; i++) { ((u8 *)buffer)[i] = next_u8(); }
}


void RandomUnsecure::seed(u64 seed) {
	m_index = (u8)seed % 256;
}
